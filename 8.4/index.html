<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>如何发布和引用服务 | bing 写字儿的地方</title><link rel="stylesheet" type="text/css" href="/libinghope/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/libinghope/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/libinghope/favicon.ico"><link rel="apple-touch-icon" href="/libinghope/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/libinghope/apple-touch-icon.png"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '7fd7a164eeb84e0acb05d20ba17a98ee';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();</script><meta name="generator" content="Hexo 4.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">如何发布和引用服务</h1><a id="logo" href="/libinghope/.">bing 写字儿的地方</a><p class="description">写写学习coding的历程，有时记也录下自己的心情</p></div><div id="nav-menu"><a class="current" href="/libinghope/."><i class="fa fa-home"> 首页</i></a><a href="/libinghope/chapter"><i class="fa fa-book"> 章节</i></a><a href="/libinghope/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/libinghope/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">如何发布和引用服务</h1><div class="post-meta">Apr 23, 2020<span> | </span><span class="category"><a href="/libinghope/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></span></div><a class="disqus-comment-count" href="/libinghope/8.4/#vcomment"><span class="valine-comment-count" data-xid="/libinghope/8.4/"></span><span> 条评论</span></a><div class="post-content"><p>想要构建微服务，首先要解决的问题是，服务提供者如何发布一个服务，服务消费者如何引用这个服务。具体来说，就是这个服务的接口名是什么？调用这个服务需要传递哪些参数？接口的返回值是什么类型？以及一些其他接口描述信息。</p>
<p>前面说过，最常见的服务发布和引用的方式有三种：RESTful API，XML 配置，IDL 文件。</p>
<h2 id="RESTful-API"><a href="#RESTful-API" class="headerlink" title="RESTful API"></a>RESTful API</h2><p>首先来说说 RESTful API 的方式，主要被用作 HTTP 或者 HTTPS 协议的接口定义，即使在非微服务架构体系下，也被广泛采用。</p>
<p>下面是开源服务化框架Motan发布 RESTful API 的例子，它发布了三个 RESTful 格式的 API，接口声明如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Path</span>(<span class="string">"/rest"</span>)</span><br><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">RestfulService</span> </span>&#123;</span><br><span class="line">     <span class="meta">@GET</span></span><br><span class="line">     <span class="meta">@Produces</span>(MediaType.APPLICATION_JSON)</span><br><span class="line">     <span class="function">List&lt;User&gt; <span class="title">getUsers</span><span class="params">(@QueryParam(<span class="string">"uid"</span>)</span> <span class="keyword">int</span> uid)</span>;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@GET</span></span><br><span class="line">     <span class="meta">@Path</span>(<span class="string">"/primitive"</span>)</span><br><span class="line">     <span class="meta">@Produces</span>(MediaType.TEXT_PLAIN)</span><br><span class="line">     <span class="function">String <span class="title">testPrimitiveType</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@POST</span></span><br><span class="line">     <span class="meta">@Consumes</span>(MediaType.APPLICATION_FORM_URLENCODED)</span><br><span class="line">     <span class="meta">@Produces</span>(MediaType.APPLICATION_JSON)</span><br><span class="line">     <span class="function">Response <span class="title">add</span><span class="params">(@FormParam(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id, @<span class="title">FormParam</span><span class="params">(<span class="string">"name"</span>)</span> String name)</span>;</span><br></pre></td></tr></table></figure>

<p>具体实现如下所示:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RestfulServerDemo</span> <span class="keyword">implements</span> <span class="title">RestfulService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">     <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getUsers</span><span class="params">(@CookieParam(<span class="string">"uid"</span>)</span> <span class="keyword">int</span> uid) </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> Arrays.asList(<span class="keyword">new</span> User(uid, <span class="string">"name"</span> + uid));</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">     <span class="function"><span class="keyword">public</span> String <span class="title">testPrimitiveType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="string">"helloworld!"</span>;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="meta">@Override</span></span><br><span class="line">     <span class="function"><span class="keyword">public</span> Response <span class="title">add</span><span class="params">(@FormParam(<span class="string">"id"</span>)</span> <span class="keyword">int</span> id, @<span class="title">FormParam</span><span class="params">(<span class="string">"name"</span>)</span> String name) </span>&#123;</span><br><span class="line">         <span class="keyword">return</span> Response.ok().cookie(<span class="keyword">new</span> NewCookie(<span class="string">"ck"</span>, String.valueOf(id))).entity(<span class="keyword">new</span> User(id, name)).build();</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>

<p>服务提供者这一端通过部署代码到 Tomcat 中，并配置 Tomcat 中如下的 web.xml，就可以通过 servlet 的方式对外提供 RESTful API。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>com.weibo.api.motan.protocol.restful.support.servlet.RestfulServletContainerListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>resteasy.servlet.mapping.prefix<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>/servlet<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span>  <span class="comment">&lt;!-- 此处实际为servlet-mapping的url-pattern，具体配置见resteasy文档--&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcher<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/servlet/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这样服务消费者就可以通过 HTTP 协议调用服务了，因为 HTTP 协议本身是一个公开的协议，对于服务消费者来说几乎没有学习成本，所以比较适合用作跨业务平台之间的服务协议。比如你有一个服务，不仅需要在业务部门内部提供服务，还需要向其他业务部门提供服务，甚至开放给外网提供服务，这时候采用 HTTP 协议就比较合适，也省去了沟通服务协议的成本。</p>
<h2 id="XML-配置"><a href="#XML-配置" class="headerlink" title="XML 配置"></a>XML 配置</h2><p>接下来再来给你讲下 XML 配置方式，这种方式的服务发布和引用主要分三个步骤：</p>
<ul>
<li>服务提供者定义接口，并实现接口。</li>
<li>服务提供者进程启动时，通过加载 server.xml 配置文件将接口暴露出去。</li>
<li>服务消费者进程启动时，通过加载 client.xml 配置文件来引入要调用的接口。我继续以服务化框架 Motan 为例，它还支持以 XML 配置的方式来发布和引用服务。</li>
</ul>
<p>继续以服务化框架 Motan 为例，它还支持以 XML 配置的方式来发布和引用服务。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">FooService</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(String name)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接口实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FooServiceImpl</span> <span class="keyword">implements</span> <span class="title">FooService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        System.out.println(name + <span class="string">" invoked rpc service"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"hello "</span> + name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后服务提供者进程启动时，加载 server.xml 配置文件，开启 8002 端口监听。server.xml 配置如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xmlns:motan</span>=<span class="string">"http://api.weibo.com/schema/motan"</span></span></span><br><span class="line"><span class="tag"> <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://api.weibo.com/schema/motan http://api.weibo.com/schema/motan.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- service implemention bean --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"serviceImpl"</span> <span class="attr">class</span>=<span class="string">"quickstart.FooServiceImpl"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- exporting service by Motan --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">motan:service</span> <span class="attr">interface</span>=<span class="string">"quickstart.FooService"</span> <span class="attr">ref</span>=<span class="string">"serviceImpl"</span> <span class="attr">export</span>=<span class="string">"8002"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>服务提供者加载 server.xml 的代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        ApplicationContext applicationContext = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:motan_server.xml"</span>);</span><br><span class="line">        System.out.println(<span class="string">"server start..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>服务消费者要想调用服务，就必须在进程启动时，加载配置 client.xml，引用接口定义，然后发起调用。client.xml 配置如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:motan</span>=<span class="string">"http://api.weibo.com/schema/motan"</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://api.weibo.com/schema/motan http://api.weibo.com/schema/motan.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- reference to the remote service --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">motan:referer</span> <span class="attr">id</span>=<span class="string">"remoteService"</span> <span class="attr">interface</span>=<span class="string">"quickstart.FooService"</span> <span class="attr">directUrl</span>=<span class="string">"localhost:8002"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>服务消费者启动时，加载 client.xml 的代码如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">        ApplicationContext ctx = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"classpath:motan_client.xml"</span>);</span><br><span class="line">        FooService service = (FooService) ctx.getBean(<span class="string">"remoteService"</span>);</span><br><span class="line">        System.out.println(service.hello(<span class="string">"motan"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>就这样，通过在服务提供者和服务消费者之间维持一份对等的 XML 配置文件，来保证服务消费者按照服务提供者的约定来进行服务调用。在这种方式下，如果服务提供者变更了接口定义，不仅需要更新服务提供者加载的接口描述文件 server.xml，还需要同时更新服务消费者加载的接口描述文件 client.xml。</p>
<p>一般是私有 RPC 框架会选择 XML 配置这种方式来描述接口，因为私有 RPC 协议的性能要比 HTTP 协议高，所以在对性能要求比较高的场景下，采用 XML 配置的方式比较合适。但这种方式对业务代码侵入性比较高，XML 配置有变更的时候，服务消费者和服务提供者都要更新，所以适合公司内部联系比较紧密的业务之间采用。如果要应用到跨部门之间的业务调用，一旦有 XML 配置变更，需要花费大量精力去协调不同部门做升级工作。在我经历的实际项目里，就遇到过一次底层服务的接口升级，需要所有相关的调用方都升级，为此花费了大量时间去协调沟通不同部门之间的升级工作，最后经历了大半年才最终完成。所以对于 XML 配置方式的服务描述，一旦应用到多个部门之间的接口格式约定，如果有变更，最好是新增接口，不到万不得已不要对原有的接口格式做变更。</p>
<h2 id="IDL-文件"><a href="#IDL-文件" class="headerlink" title="IDL 文件"></a>IDL 文件</h2><p>IDL 就是接口描述语言（interface description language）的缩写，通过一种中立的方式来描述接口，使得在不同的平台上运行的对象和不同语言编写的程序可以相互通信交流。比如你用 Java 语言实现提供的一个服务，也能被 PHP 语言调用。</p>
<p>也就是说 IDL 主要是用作跨语言平台的服务之间的调用，有两种最常用的 IDL：一个是 Facebook 开源的 Thrift 协议，另一个是 Google 开源的 gRPC 协议。无论是 Thrift 协议还是 gRPC 协议，它们的工作原理都是类似的。</p>
<p>接下来，我以 gRPC 协议为例，给你讲讲如何使用 IDL 文件方式来描述接口。</p>
<p>gRPC 协议使用 Protobuf 简称 proto 文件来定义接口名、调用参数以及返回值类型。</p>
<p>比如文件 helloword.proto 定义了一个接口 SayHello 方法，它的请求参数是 HelloRequest，它的返回值是 HelloReply。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// The greeter service definition.</span></span><br><span class="line">service Greeter &#123;</span><br><span class="line">  <span class="comment">// Sends a greeting</span></span><br><span class="line">  <span class="function">rpc <span class="title">SayHello</span> <span class="params">(HelloRequest)</span> <span class="title">returns</span> <span class="params">(HelloReply)</span> </span>&#123;&#125;</span><br><span class="line">  <span class="function">rpc <span class="title">SayHelloAgain</span> <span class="params">(HelloRequest)</span> <span class="title">returns</span> <span class="params">(HelloReply)</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The request message containing the user's name.</span></span><br><span class="line">message HelloRequest &#123;</span><br><span class="line">  string name = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The response message containing the greetings</span></span><br><span class="line">message HelloReply &#123;</span><br><span class="line">  string message = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>假如服务提供者使用的是 Java 语言，那么利用 protoc 插件即可自动生成 Server 端的 Java 代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">GreeterImpl</span> <span class="keyword">extends</span> <span class="title">GreeterGrpc</span>.<span class="title">GreeterImplBase</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHello</span><span class="params">(HelloRequest req, StreamObserver&lt;HelloReply&gt; responseObserver)</span> </span>&#123;</span><br><span class="line">    HelloReply reply = HelloReply.newBuilder().setMessage(<span class="string">"Hello "</span> + req.getName()).build();</span><br><span class="line">    responseObserver.onNext(reply);</span><br><span class="line">    responseObserver.onCompleted();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sayHelloAgain</span><span class="params">(HelloRequest req, StreamObserver&lt;HelloReply&gt; responseObserver)</span> </span>&#123;</span><br><span class="line">    HelloReply reply = HelloReply.newBuilder().setMessage(<span class="string">"Hello again "</span> + req.getName()).build();</span><br><span class="line">    responseObserver.onNext(reply);</span><br><span class="line">    responseObserver.onCompleted();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>假如服务消费者使用的也是 Java 语言，那么利用 protoc 插件即可自动生成 Client 端的 Java 代码。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">greet</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">  logger.info(<span class="string">"Will try to greet "</span> + name + <span class="string">" ..."</span>);</span><br><span class="line">  HelloRequest request = HelloRequest.newBuilder().setName(name).build();</span><br><span class="line">  HelloReply response;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    response = blockingStub.sayHello(request);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (StatusRuntimeException e) &#123;</span><br><span class="line">    logger.log(Level.WARNING, <span class="string">"RPC failed: &#123;0&#125;"</span>, e.getStatus());</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  logger.info(<span class="string">"Greeting: "</span> + response.getMessage());</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    response = blockingStub.sayHelloAgain(request);</span><br><span class="line">  &#125; <span class="keyword">catch</span> (StatusRuntimeException e) &#123;</span><br><span class="line">    logger.log(Level.WARNING, <span class="string">"RPC failed: &#123;0&#125;"</span>, e.getStatus());</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  logger.info(<span class="string">"Greeting: "</span> + response.getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>假如服务消费者使用的是 PHP 语言，那么利用 protoc 插件即可自动生成 Client 端的 PHP 代码。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">$request = <span class="keyword">new</span> Helloworld\HelloRequest();</span><br><span class="line">$request-&gt;setName($name);</span><br><span class="line"><span class="keyword">list</span>($reply, $status) = $client-&gt;SayHello($request)-&gt;wait();</span><br><span class="line">$message = $reply-&gt;getMessage();</span><br><span class="line"><span class="keyword">list</span>($reply, $status) = $client-&gt;SayHelloAgain($request)-&gt;wait();</span><br><span class="line">$message = $reply-&gt;getMessage();</span><br></pre></td></tr></table></figure>

<p>可见，gRPC 协议的服务描述是通过 proto 文件来定义接口的，然后再使用 protoc 来生成不同语言平台的客户端和服务端代码，从而具备跨语言服务调用能力。</p>
<p>有一点特别需要注意的是，在描述接口定义时，IDL 文件需要对接口返回值进行详细定义。如果接口返回值的字段比较多，并且经常变化时，采用 IDL 文件方式的接口定义就不太合适了。一方面可能会造成 IDL 文件过大难以维护，另一方面只要 IDL 文件中定义的接口返回值有变更，都需要同步所有的服务消费者都更新，管理成本就太高了。</p>
<p>课程老师老师在项目实践过程中，曾经考虑过采用 Protobuf 文件来描述微博内容接口，但微博内容返回的字段有几百个，并且有些字段不固定，返回什么字段是业务方自定义的，这种情况采用 Protobuf 文件来描述的话会十分麻烦，所以最终不得不放弃这种方式。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>今天介绍了服务描述最常见的三种方式：RESTful API、XML 配置以及 IDL 文件。</p>
<p>具体采用哪种服务描述方式是根据实际情况决定的，通常情况下，如果只是企业内部之间的服务调用，并且都是 Java 语言的话，选择 XML 配置方式是最简单的。如果企业内部存在多个服务，并且服务采用的是不同语言平台，建议使用 IDL 文件方式进行描述服务。如果还存在对外开放服务调用的情形的话，使用 RESTful API 方式则更加通用。</p>
<p><img src="https://pic.downk.cc/item/5ebe53bcc2a9a83be598b774.jpg" alt="三种服务描述方式的比较"></p>
</div><iframe src="/libinghope//donate/?AliPayQR=https://i.loli.net/2020/03/01/p9zFe7XOC6VufSx.jpg&amp;WeChatQR=https://i.loli.net/2020/03/01/p5tMeDmHyxXrNz4.jpg&amp;GitHub=null&amp;BTCQR=null&amp;BTCKEY=null&amp;PayPal=null" style="overflow-x:hidden; overflow-y:hidden; border:0xp none #fff; min-height:240px; width:100%;" frameborder="0" scrolling="no"></iframe><div class="tags"><a href="/libinghope/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></div><div class="post-nav"><a class="pre" href="/libinghope/8.5/">如何注册和发现服务</a><a class="next" href="/libinghope/8.3/">初探微服务架构</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'false' ? true : false;
var verify = 'false' ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'meCnSRCi15eMEjaE2H9RbDy9-gzGzoHsz',
  appKey:'4VIq3rUwuA5gUTs67FEheUPQ',
  placeholder:'不想说点什么吗?',
  avatar:'bing',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank"><input type="search" name="word" maxlength="20" placeholder="Search"/><input type="hidden" name="si" value="https://libinghope.github.io"/><input name="tn" type="hidden" value="bds"/><input name="cl" type="hidden" value="3"/><input name="ct" type="hidden" value="2097152"/><input name="s" type="hidden" value="on"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/libinghope/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/libinghope/categories/%E4%B8%AD%E5%8F%B0/">中台</a></li><li class="category-list-item"><a class="category-list-link" href="/libinghope/categories/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/">开发环境</a></li><li class="category-list-item"><a class="category-list-link" href="/libinghope/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a></li><li class="category-list-item"><a class="category-list-link" href="/libinghope/categories/%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD/">必备技能</a></li><li class="category-list-item"><a class="category-list-link" href="/libinghope/categories/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></li><li class="category-list-item"><a class="category-list-link" href="/libinghope/categories/%E7%AC%94%E8%AE%B0/">笔记</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/libinghope/categories/%E7%AC%94%E8%AE%B0/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">操作系统</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/libinghope/categories/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/">编译原理</a></li><li class="category-list-item"><a class="category-list-link" href="/libinghope/categories/%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84/">软件架构</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/libinghope/tags/%E5%BC%80%E5%8F%91/" style="font-size: 15px;">开发</a> <a href="/libinghope/tags/%E8%BD%AF%E4%BB%B6/" style="font-size: 15px;">软件</a> <a href="/libinghope/tags/%E9%85%8D%E7%BD%AE/" style="font-size: 15px;">配置</a> <a href="/libinghope/tags/vscode/" style="font-size: 15px;">vscode</a> <a href="/libinghope/tags/%E6%8F%92%E4%BB%B6/" style="font-size: 15px;">插件</a> <a href="/libinghope/tags/git/" style="font-size: 15px;">git</a> <a href="/libinghope/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" style="font-size: 15px;">服务器</a> <a href="/libinghope/tags/go/" style="font-size: 15px;">go</a> <a href="/libinghope/tags/%E5%8D%9A%E5%AE%A2/" style="font-size: 15px;">博客</a> <a href="/libinghope/tags/%E5%88%A0%E5%BA%93/" style="font-size: 15px;">删库</a> <a href="/libinghope/tags/%E5%BF%85%E5%A4%87/" style="font-size: 15px;">必备</a> <a href="/libinghope/tags/%E6%8A%80%E8%83%BD/" style="font-size: 15px;">技能</a> <a href="/libinghope/tags/%E6%AD%A3%E5%88%99/" style="font-size: 15px;">正则</a> <a href="/libinghope/tags/golang/" style="font-size: 15px;">golang</a> <a href="/libinghope/tags/govendor/" style="font-size: 15px;">govendor</a> <a href="/libinghope/tags/%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD/" style="font-size: 15px;">必备技能</a> <a href="/libinghope/tags/docker/" style="font-size: 15px;">docker</a> <a href="/libinghope/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" style="font-size: 15px;">操作系统</a> <a href="/libinghope/tags/%E7%BC%96%E7%A8%8B/" style="font-size: 15px;">编程</a> <a href="/libinghope/tags/%E8%B0%83%E5%BA%A6/" style="font-size: 15px;">调度</a> <a href="/libinghope/tags/%E7%BA%BF%E7%A8%8B/" style="font-size: 15px;">线程</a> <a href="/libinghope/tags/%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/" style="font-size: 15px;">系统调用</a> <a href="/libinghope/tags/%E5%A4%8D%E6%9D%82%E7%B3%BB%E7%BB%9F/" style="font-size: 15px;">复杂系统</a> <a href="/libinghope/tags/%E8%BF%9B%E7%A8%8B/" style="font-size: 15px;">进程</a> <a href="/libinghope/tags/%E5%90%8C%E6%AD%A5/" style="font-size: 15px;">同步</a> <a href="/libinghope/tags/%E4%BF%A1%E5%8F%B7%E9%87%8F/" style="font-size: 15px;">信号量</a> <a href="/libinghope/tags/%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8/" style="font-size: 15px;">内存使用</a> <a href="/libinghope/tags/%E5%88%86%E6%AE%B5/" style="font-size: 15px;">分段</a> <a href="/libinghope/tags/%E5%86%85%E5%AD%98/" style="font-size: 15px;">内存</a> <a href="/libinghope/tags/%E6%8D%A2%E5%85%A5%E6%8D%A2%E5%87%BA/" style="font-size: 15px;">换入换出</a> <a href="/libinghope/tags/%E5%88%86%E5%8C%BA/" style="font-size: 15px;">分区</a> <a href="/libinghope/tags/%E5%88%87%E6%8D%A2/" style="font-size: 15px;">切换</a> <a href="/libinghope/tags/%E6%8E%A5%E5%8F%A3/" style="font-size: 15px;">接口</a> <a href="/libinghope/tags/%E8%B0%83%E7%94%A8/" style="font-size: 15px;">调用</a> <a href="/libinghope/tags/CPU/" style="font-size: 15px;">CPU</a> <a href="/libinghope/tags/%E6%A6%82%E5%BF%B5/" style="font-size: 15px;">概念</a> <a href="/libinghope/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" style="font-size: 15px;">编译原理</a> <a href="/libinghope/tags/%E5%86%85%E6%A0%B8%E7%BA%BF%E7%A8%8B/" style="font-size: 15px;">内核线程</a> <a href="/libinghope/tags/%E5%85%AC%E5%BC%8F%E8%AE%A1%E7%AE%97/" style="font-size: 15px;">公式计算</a> <a href="/libinghope/tags/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/" style="font-size: 15px;">前端技术</a> <a href="/libinghope/tags/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90/" style="font-size: 15px;">词法分析</a> <a href="/libinghope/tags/linux/" style="font-size: 15px;">linux</a> <a href="/libinghope/tags/poll/" style="font-size: 15px;">poll</a> <a href="/libinghope/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 15px;">网络</a> <a href="/libinghope/tags/udp/" style="font-size: 15px;">udp</a> <a href="/libinghope/tags/%E5%A4%9A%E8%BF%9B%E7%A8%8B/" style="font-size: 15px;">多进程</a> <a href="/libinghope/tags/%E5%AD%98%E5%82%A8%E6%98%A0%E5%B0%84/" style="font-size: 15px;">存储映射</a> <a href="/libinghope/tags/%E9%80%9A%E4%BF%A1/" style="font-size: 15px;">通信</a> <a href="/libinghope/tags/%E4%BF%A1%E5%8F%B7/" style="font-size: 15px;">信号</a> <a href="/libinghope/tags/%E5%8D%8F%E8%AE%AE%E6%A0%BC%E5%BC%8F/" style="font-size: 15px;">协议格式</a> <a href="/libinghope/tags/%E7%BD%91%E7%BB%9C%E5%8D%8F%E8%AE%AE/" style="font-size: 15px;">网络协议</a> <a href="/libinghope/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 15px;">多线程</a> <a href="/libinghope/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 15px;">架构</a> <a href="/libinghope/tags/%E5%88%86%E5%B1%82/" style="font-size: 15px;">分层</a> <a href="/libinghope/tags/%E5%A5%97%E6%8E%A5%E5%AD%97/" style="font-size: 15px;">套接字</a> <a href="/libinghope/tags/Socket/" style="font-size: 15px;">Socket</a> <a href="/libinghope/tags/%E6%96%B9%E6%A1%88/" style="font-size: 15px;">方案</a> <a href="/libinghope/tags/%E5%8E%9F%E5%88%99/" style="font-size: 15px;">原则</a> <a href="/libinghope/tags/NoSql/" style="font-size: 15px;">NoSql</a> <a href="/libinghope/tags/%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/" style="font-size: 15px;">分库分表</a> <a href="/libinghope/tags/%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/" style="font-size: 15px;">读写分离</a> <a href="/libinghope/tags/PPC/" style="font-size: 15px;">PPC</a> <a href="/libinghope/tags/TPC/" style="font-size: 15px;">TPC</a> <a href="/libinghope/tags/Reactor/" style="font-size: 15px;">Reactor</a> <a href="/libinghope/tags/Proactor/" style="font-size: 15px;">Proactor</a> <a href="/libinghope/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" style="font-size: 15px;">负载均衡</a> <a href="/libinghope/tags/FMEA/" style="font-size: 15px;">FMEA</a> <a href="/libinghope/tags/CAP%E7%90%86%E8%AE%BA/" style="font-size: 15px;">CAP理论</a> <a href="/libinghope/tags/%E9%9B%86%E7%BE%A4/" style="font-size: 15px;">集群</a> <a href="/libinghope/tags/%E4%B8%9A%E5%8A%A1/" style="font-size: 15px;">业务</a> <a href="/libinghope/tags/%E5%BC%82%E5%9C%B0%E5%A4%9A%E6%B4%BB/" style="font-size: 15px;">异地多活</a> <a href="/libinghope/tags/%E9%AB%98%E5%8F%AF%E7%94%A8/" style="font-size: 15px;">高可用</a> <a href="/libinghope/tags/%E6%95%85%E9%9A%9C/" style="font-size: 15px;">故障</a> <a href="/libinghope/tags/SOA/" style="font-size: 15px;">SOA</a> <a href="/libinghope/tags/%E5%BE%AE%E5%86%85%E6%A0%B8/" style="font-size: 15px;">微内核</a> <a href="/libinghope/tags/%E6%8A%80%E6%9C%AF%E6%BC%94%E8%BF%9B/" style="font-size: 15px;">技术演进</a> <a href="/libinghope/tags/%E5%A4%8D%E6%9D%82%E5%BA%A6/" style="font-size: 15px;">复杂度</a> <a href="/libinghope/tags/APP/" style="font-size: 15px;">APP</a> <a href="/libinghope/tags/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/" style="font-size: 15px;">开源项目</a> <a href="/libinghope/tags/%E4%B8%AD%E5%8F%B0/" style="font-size: 15px;">中台</a> <a href="/libinghope/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" style="font-size: 15px;">微服务</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/libinghope/2.8/">golang包管理工具govendor使用方法</a></li><li class="post-list-item"><a class="post-list-link" href="/libinghope/2.7/">docker十分钟上手</a></li><li class="post-list-item"><a class="post-list-link" href="/libinghope/8.11/">gRPC初步认识</a></li><li class="post-list-item"><a class="post-list-link" href="/libinghope/8.10/">Dubbo框架里的微服务组件</a></li><li class="post-list-item"><a class="post-list-link" href="/libinghope/8.9/">微服务治理的手段有哪些</a></li><li class="post-list-item"><a class="post-list-link" href="/libinghope/8.8/">如何追踪微服务调用</a></li><li class="post-list-item"><a class="post-list-link" href="/libinghope/8.7/">如何监控微服务调用</a></li><li class="post-list-item"><a class="post-list-link" href="/libinghope/8.6/">如何实现RPC远程服务调用</a></li><li class="post-list-item"><a class="post-list-link" href="/libinghope/8.5/">如何注册和发现服务</a></li><li class="post-list-item"><a class="post-list-link" href="/libinghope/8.4/">如何发布和引用服务</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://wangpansearch.com" title="网盘搜索" target="_blank">网盘搜索</a><ul></ul><a href="\#" title="友情链接2" target="_blank">友情链接2</a><ul></ul><a href="\#" title="友情链接3" target="_blank">友情链接3</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/libinghope/." rel="nofollow">bing 写字儿的地方.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/libinghope/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/libinghope/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/libinghope/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/libinghope/js/smartresize.js?v=0.0.0"></script></div></body></html>